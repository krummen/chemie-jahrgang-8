<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baukasten: Interaktive Herleitung NaCl</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6; color: #333; max-width: 800px; margin: 2rem auto;
            padding: 0 1rem; background-color: #f9f9f9;
        }
        h2 {
            color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;
        }
        .container {
            background-color: #ffffff; padding: 2rem; border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .info-block {
            background-color: #ecf0f1; border-left: 5px solid #3498db; padding: 15px;
            margin: 1rem 0; border-radius: 0 5px 5px 0;
        }
        .nav-btn {
            display: inline-block; background-color: #3498db; color: #ffffff; padding: 12px 25px;
            border-radius: 5px; text-decoration: none; font-size: 1.1em; border: none; cursor: pointer;
            margin-top: 1.5rem; transition: background-color 0.3s;
        }
        .nav-btn.secondary {
             background-color: #7f8c8d;
        }
        .nav-btn:hover:not(:disabled) { background-color: #2980b9; }
        .nav-btn.secondary:hover:not(:disabled) { background-color: #34495e; }
        .herleitung-step, .choice-container, .feedback-gif {
            display: none;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 1rem;
            text-align: center;
        }
        .feedback-gif { border: none; }
        .svg-drawing {
            width: 100%;
            max-width: 400px;
            min-height: 120px;
        }
        .button-wrapper {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 1rem;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Interaktive Herleitung: Natriumchlorid (NaCl)</h2>
        <p class="info-block">Wir wollen die Summenformel für Natriumchlorid (Kochsalz) finden. Nach jedem Schritt kannst du entscheiden, ob du alleine weitermachen möchtest.</p>
        
        <div id="nacl-herleitung">
            <!-- Step 1 -->
            <div class="herleitung-step" id="step-1">
                <p>1. Unsere Bausteine sind sind Natrium-Atome (Na) und Chlor-Atome (Cl). Da wir noch nicht wissen, wie viele davon wir benötigen, starten wir mit jeweils einem von jedem.</p>
                <div id="nacl-step1-svg"></div>
            </div>
            
            <!-- Choice 1 -->
            <div class="choice-container" id="choice-1">
                <p>Schaffst du den Rest alleine?</p>
                <div class="button-wrapper">
                    <button class="nav-btn secondary" data-skip-feedback>Ja, Rest alleine</button>
                    <button class="nav-btn" data-next-step="2">Nächsten Schritt anzeigen</button>
                </div>
            </div>

            <!-- Step 2 -->
            <div class="herleitung-step" id="step-2">
                <p>2. Aus unserer Wertigkeits-Tabelle wissen wir: Natrium (Na) und Chlor (Cl) haben beide die Wertigkeit I (jeweils 1 Arm).</p>
                <div id="nacl-step2-svg"></div>
            </div>

            <!-- Choice 2 -->
            <div class="choice-container" id="choice-2">
                 <p>Schaffst du den Rest alleine?</p>
                <div class="button-wrapper">
                    <button class="nav-btn secondary" data-skip-feedback>Ja, Rest alleine</button>
                    <button class="nav-btn" data-next-step="3">Nächsten Schritt anzeigen</button>
                </div>
            </div>

            <!-- Step 3 -->
            <div class="herleitung-step" id="step-3">
                <p>3. Wir müssen die Atome so kombinieren, dass <strong>keine Bindungsstelle unbesetzt bleibt</strong>. Das war´s schon, fertig.</p>
                <div id="nacl-step3-svg"></div>
            </div>
            
            <!-- Choice 3 -->
            <div class="choice-container" id="choice-3">
                 <p>Bist du bereit für die Lösung?</p>
                <div class="button-wrapper">
                    <button class="nav-btn" data-next-step="final">Lösung anzeigen</button>
                </div>
            </div>

            <!-- Final Step -->
            <div class="herleitung-step" id="step-final">
                <p>4. Die Lösung ist einfach: Ein Na-Atom passt perfekt zu einem Cl-Atom. Alle Arme sind verbunden.</p>
                <div id="nacl-final-svg"></div>
                <p class="info-block" style="margin-top: 2rem;">Aus diesem Modell können wir jetzt die Summenformel ablesen: 1 Natrium-Atom und 1 Chlor-Atom. Die Formel lautet also: <strong>NaCl</strong>.</p>
            </div>

            <!-- Feedback GIF -->
            <div class="feedback-gif" id="skip-feedback-gif">
                 <div class="tenor-gif-embed" data-postid="9181333401381757341" data-share-method="host" data-aspect-ratio="1.04762" data-width="20%"></div>
            </div>
        </div>
        <button class="nav-btn" id="start-herleitung-btn">Herleitung starten</button>
    </div>
    <script type="text/javascript" async src="https://tenor.com/embed.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // --- SVG ENGINE ---
    function drawAtomWithSymbol(symbol, radius, color = 'white', arms = 0, armAngles = []) {
        const fontSize = radius * 1.5;
        let armPaths = '';
        if (arms > 0) {
            const armLength = radius * 0.8;
            for (const angle of armAngles) {
                const x1 = radius;
                const x2 = radius + armLength;
                armPaths += `<line x1="${x1}" y1="0" x2="${x2}" y2="0" stroke="black" stroke-width="3" stroke-linecap="round" transform="rotate(${angle})"/>`;
            }
        }
        return `<g><circle cx="0" cy="0" r="${radius}" fill="${color}" stroke="black" stroke-width="2" /><text x="0" y="0" font-family="Arial, sans-serif" font-size="${fontSize}" font-weight="bold" text-anchor="middle" dy=".3em">${symbol}</text>${armPaths}</g>`;
    }
    
    // --- Definitionen ---
    const naAtom = { x: 50, y: 60, r: 20, color: '#bdc3c7' };
    const clAtom = { x: 150, y: 60, r: 20, color: '#2ecc71' };
    const viewBox = `0 0 200 120`;

    // --- RENDER SVGs ---
    document.getElementById('nacl-step1-svg').innerHTML = `<svg viewBox="${viewBox}" class="svg-drawing">
        <g transform="translate(${naAtom.x}, ${naAtom.y})">${drawAtomWithSymbol('Na', naAtom.r, naAtom.color)}</g>
        <g transform="translate(${clAtom.x}, ${clAtom.y})">${drawAtomWithSymbol('Cl', clAtom.r, clAtom.color)}</g>
    </svg>`;
    
    document.getElementById('nacl-step2-svg').innerHTML = `<svg viewBox="${viewBox}" class="svg-drawing">
        <g transform="translate(${naAtom.x}, ${naAtom.y})">${drawAtomWithSymbol('Na', naAtom.r, naAtom.color, 1, [0])}</g>
        <g transform="translate(${clAtom.x}, ${clAtom.y})">${drawAtomWithSymbol('Cl', clAtom.r, clAtom.color, 1, [180])}</g>
    </svg>`;

    document.getElementById('nacl-step3-svg').innerHTML = `<svg viewBox="${viewBox}" class="svg-drawing">
        <g transform="translate(${naAtom.x}, ${naAtom.y})">${drawAtomWithSymbol('Na', naAtom.r, naAtom.color, 1, [0])}</g>
        <g transform="translate(${clAtom.x}, ${clAtom.y})">${drawAtomWithSymbol('Cl', clAtom.r, clAtom.color, 1, [180])}</g>
        <text x="100" y="60" font-family="Arial, sans-serif" font-size="30" fill="#3498db" text-anchor="middle" dy=".3em">↔</text>
    </svg>`;

    const final_na_center = { x: 80, y: 60 };
    const final_cl_center = { x: 120, y: 60 };
    document.getElementById('nacl-final-svg').innerHTML = `<svg viewBox="${viewBox}" class="svg-drawing">
        <g>
            <line x1="${final_na_center.x}" y1="${final_na_center.y}" x2="${final_cl_center.x}" y2="${final_cl_center.y}" stroke="black" stroke-width="3"/>
            <g transform="translate(${final_na_center.x}, ${final_na_center.y})">${drawAtomWithSymbol('Na', naAtom.r, naAtom.color)}</g>
            <g transform="translate(${final_cl_center.x}, ${final_cl_center.y})">${drawAtomWithSymbol('Cl', clAtom.r, clAtom.color)}</g>
        </g>
    </svg>`;

    // --- INTERACTIVITY LOGIC ---
    const startBtn = document.getElementById('start-herleitung-btn');
    const steps = document.querySelectorAll('.herleitung-step');
    const choices = document.querySelectorAll('.choice-container');
    const feedbackGif = document.getElementById('skip-feedback-gif');
    startBtn.addEventListener('click', () => {
        startBtn.style.display = 'none';
        steps[0].style.display = 'block';
        choices[0].style.display = 'block';
    });
    choices.forEach((choice, index) => {
        const nextStepBtn = choice.querySelector('[data-next-step]');
        const skipBtn = choice.querySelector('[data-skip-feedback]');
        const finalBtn = choice.querySelector('[data-next-step="final"]');
        if (nextStepBtn) {
            nextStepBtn.addEventListener('click', () => {
                choice.style.display = 'none';
                const nextStepIndex = parseInt(nextStepBtn.dataset.nextStep) - 1;
                if(nextStepIndex < steps.length-1) {
                     steps[nextStepIndex].style.display = 'block';
                     choices[nextStepIndex].style.display = 'block';
                } else { steps[nextStepIndex].style.display = 'block'; }
            });
        }
        if(finalBtn) {
             finalBtn.addEventListener('click', () => {
                steps.forEach(s => s.style.display = 'none');
                choices.forEach(c => c.style.display = 'none');
                document.getElementById('step-final').style.display = 'block';
            });
        }
        if (skipBtn) {
            skipBtn.addEventListener('click', () => {
                choice.style.display = 'none';
                feedbackGif.style.display = 'block';
                setTimeout(() => {
                    feedbackGif.style.display = 'none';
                    choice.style.display = 'block';
                }, 1500);
            });
        }
    });
});
</script>
</body>
</html>